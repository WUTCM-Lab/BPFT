# BPFT
PyTorch implementation of "[Bilinear Parallel Fourier Transformer for Multimodal Remote Sensing Classification]" (accepted by TGRS)
* 论文地址：https://ieeexplore.ieee.org/document/10945964

## 摘要
视觉变换器（ViTs）在多模态融合图像分类方面已显示出良好的前景，但在复杂的遥感场景中仍面临性能挑战。单一的融合框架往往无法充分利用多模态多样性，而且图像类别分布不均也使变换器准确构建空间结构变得更加复杂。此外，传统的交叉熵往往偏向于多数类别，而忽略了少数类别，从而导致预测效果不理想，整体准确性降低。为了解决这些难题，本文提出了一种新型深度神经网络--双线性并行傅立叶变换器（BPFT）。本文提出了一种新颖的双融合特征交互（DFFI）模块，利用两种不同类型的融合特征进行学习，即空间-光谱融合特征和全局融合特征。此外，本文还引入了双特征交互模块，以提高融合特征信息的利用率。为了让变换器更好地建立空间结构关系，本文采用了傅立叶变换来代替自注意机制。为了解决对少数类别标签的关注，本文提出了指数标签平滑交叉熵损失函数。该损失函数由两部分组成：指数交叉熵和标签平滑。指数交叉熵部分对分类错误的样本进行强力惩罚，从而提高了对少数类别标签的关注度。为了验证本文方法的有效性，在两个多模式遥感数据集上进行了广泛的实验： 奥格斯堡和柏林这两个多模态遥感数据集包含 HSI 数据和合成孔径雷达数据。实验结果表明，与现有的最先进模型相比，本文提出的 BPFT 模型在多模态遥感图像分类任务中表现出色。

## Part.01 研究贡献
1. 本文介绍了一种新颖的 DFFI 框架，它能够同时学习两种不同类型的特征。这代表了多模态遥感图像分类中特征融合的一种开创性方法。
2. 本文提出了一种新颖的傅立叶变换器编码器，将傅立叶变换集成到变换器的注意机制中。这将图像从时域转换到频域进行特征学习，增强了模型对数据的泛化能力。
3. 本文提出一个新颖的双特征交互模块，旨在通过在同时学习两个融合特征的过程中利用互补信息来促进特征融合。
4. 本文提出一种基于传统交叉熵的新型指数标签平滑交叉熵损失函数。这种新的损失函数通过结合指数函数和标签平滑，调整了对少数类别标签的关注。
5. 在两个公开的遥感数据集上进行综合实验： Augsburg和Berlin。这些实验证明了所建议方法的有效性。

## Part.02 模型结构
该模型分为两个阶段：特征提取和交互。在特征提取阶段，利用空间-光谱融合特征提取模块和全局融合特征提取模块获得空间-光谱融合特征和全局融合特征。然后应用傅里叶变换分析这些特征的空间结构。在特征交互阶段，为了进一步优化提取过程，本文引入了针对频域特征量身定制的可学习滤波器，增强了模型捕获不同模式的能力。并且双特征交互模块实现了两个融合特征之间的信息交互，提高了模型的学习效率。最后分类预测阶段，本文采用指数标签平滑交叉熵损失函数，旨在提高损失函数对代表性不足的类别标签的敏感性，特别是在复杂场景中。

## Part.03 数据集
Augsburg数据集

奥格斯堡数据集： 该数据集由德国奥格斯堡的 HSI 和合成孔径雷达数据组成。HSI 由 HySpex 机载成像光谱仪系统获取。合成孔径雷达数据由哨兵-1 传感器获取。所有图像的地面采样距离（GSD）均为 30 米。HSI 和 SAR 图像的尺寸均为 332 × 485 像素[48]。HSI 有 80 个波段，波长从 0.4 微米到 2.5 微米不等。合成孔径雷达数据有四个特征（VV 强度、VH 强度、极坐标合成孔径雷达协方差矩阵非对角元素的实部和虚部）。

Berlin数据集

该数据集涵盖柏林的城市和农村地区。HSI 数据是基于 HyMap HS 数据的模拟环境绘图和分析程序 (enmap) 的数据。合成孔径雷达数据是从欧洲航天局（ESA）获得的哨兵-1 双波尔单看复合（SLC）产品。HSI有797个像素，244个波段，波长范围为400-2500nm/cite{okujeni2016berlin}。合成孔径雷达图像的大小为 1723 x 476 像素。为了匹配两幅图像的空间分辨率，采用了近邻插值法。

## Part.04 实验结果
### 定量实验
表1显示，与 ExViT 模型相比，我们的模型有了大幅提升，OA 提高了 8.35%。此外，与预训练的 SSMAE 相比，我们的模型在 OA 方面显著提高了 2.73%。此外，我们的模型在森林、工业、低矮植物、拨款和水域区域的分类性能也有所提高，尤其是在水域和工业区域，分类性能有了显著提高。表1显示，与采用变压器骨干和自我关注的对应模型相比，我们的模型在准确率方面取得了显著进步，即使与使用预训练的 SSMAE 相比，也提高了约 3.1%。这一显著提升可归因于三个关键因素。首先，我们的模型采用了 DFFI 模块，从而为模型提供了更全面的数据图景，同时也促进了相关信息的补充，从而优化了对显著性特征的利用。其次，ESLoss（一种新颖的损失函数）的集成增强了模型在复杂场景中的导航能力，同时提高了模型的泛化能力。最后，采用傅立叶变换代替变换器固有的自注意机制，大大缩小了参数空间，从而简化了模型的收敛过程。

如表 2所示，我们的模型在柏林数据集上取得了显著进步。与 MFT 和 CrossHL 相比，我们的模型性能分别提高了 4.98% 和 6.3%。此外，与 S2ENet、ExViT、Fusion HCT、SSMAE* 和 SSMAE 模型相比，我们的模型表现出了更大的进步，分别提高了 18.68%、17.13%、18.58%、18.61% 和 16.33%。

#### <center>表1 不同方法在Augsburg数据集上的性能比较
![Augsburg](C:\Users\Administrator\Desktop\Augsburg.png)

#### <center>表2 不同方法在Berlin数据集上的性能比较
![Berlin](C:\Users\Administrator\Desktop\Berlin.png)


### 定性实验
本文将BPFT、S2ENet、MFT、CrossHL、ExViT、HCTNet、SSMAE模型在Augsburg数据集和Berlin数据集上的分类结果可视化。定性实验结果证明了BPFT在大部分场景中的鲁棒性。

#### <center>图3 BPFT与其他模型在Augsburg数据集上的可视化比较

![Augsburg_pred](C:\Users\Administrator\Desktop\Augsburg_pred.png)

#### <center>图4 BPFT与其他模型在Berlin数据集上的可视化比较

![Berlin_pred](C:\Users\Administrator\Desktop\Berlin_pred.png)

## Part.05 研究展望 
本文提出了一种新的模型，称为BPFT，它通过有效地利用HSI和SAR数据，在两个不同的数据集上证明了优于现有方法的准确性。模型架构由两个专门的分支组成，旨在捕捉不同但互补的融合特征。为了进一步优化提取过程，我们引入了针对频域特征量身定制的可学习滤波器，增强了模型捕获不同模式的能力。此外，DFI模块促进了融合特征之间的信息交换，从而提高了模型对关键特征表示的学习效率。此外，我们提出了一种创新的指数标签平滑交叉熵损失函数，旨在提高损失函数对代表性不足的类别标签的敏感性，特别是在复杂场景中。这种调整通过更好地将损失函数与语义相关性对齐，显著提高了模型的分类性能。我们的实验结果证实了BPFT模型在提取综合语义特征方面的有效性，从而在各种场景中实现了稳健的分类性能。然而，数据集中标签分布不平衡会影响模型的学习能力，特别是影响标签实例较少的类别，导致学习性能下降。因此，我们未来的研究将优先解决标签分布不均匀的数据集中多模态分类任务带来的挑战。

